---
title: "Kaigi on Rails STAY HOME Edition 配信の裏側"
date: 2020-10-17 18:18 JST
tags: 
- kaigionrails
- diary
- obs
---

![配信構成](2020/kaigionrails-backstage.png)

##  御礼
Kaigi on Railsという初めてのイベントに参加していただいた皆様、素晴らしい発表をしてくださった発表者の皆様、惜しくも採択とはいかなかったものの、Proposalを提出してくださった皆様、協賛していただいたスポンサーの皆様、本当にありがとうございます。

## 誰
Kaigi on RailsではProposal提出まわりと、yrindaさんと一緒に配信・動画まわりを担当していたうなすけです。

<https://kaigionrails.org/team/>

この記事では、完全オンライン開催にあたっての配信まわりについて、裏側がどうだったかについて触れるものです。リアル開催からオンライン開催に切り替えた苦労話なんかはチーフオーガナイザー氏が書いてくれたのでここでは触れません。

[Kaigi on Railsのチーフオーガナイザーを務めました - okuramasafumiのブログ](https://okuramasafumi.hatenablog.jp/entry/2020/10/07/212138)

## はじめに本番構成
全てをすっ飛ばして、本番の配信環境をまず紹介します。

本番配信はメインのyrinda houseとサブのunasuke houseの2系統を用意して冗長化していました。メインで何か問題が発生したらサブ側の配信URLを広報し、そちらを視聴してもらうイメージでした。そのために2人が同じ内容をメインとサブで配信する必要があり、シーンの切り替えタイミング等は当日全員が入っているDiscordでタイミングを合わせて行っていました。

ライブ発表の場合の構成は、アプリケーション側のZoomを発表者の映像用に、モニターを1枚占有した状態のブラウザからZoomに入り発表資料用に、そしてこれらをOBSに流しこみました。
その他に、それらの画面に重ねる発表情報の枠、Zoomからの音声出力キャプチャなどの設定をライブ発表用に用意しました。

![配信構成図](2020/kaigionrails-backstage-architecture.png)

動画発表の場合は、発表する方々から事前に提出いただいた動画を、同様の見た目になるよう発表用の枠をかぶせて書き出し、当日は再生するのみの運用になるようにしました。

当日のタイムテーブルの進行については、発表者、休憩それぞれでOBSのシーンを作成し、基本的にはそれを上から切り替えていくという省エネ運用になるように配信担当側で協力して作り込んでいきました。

![OBS scene構成](2020/kaigionrails-obs-scenes.png)

## それまでのストーリー
まず当初、Kaigi on Railsはリアル会場で開催するつもりでした。ところが時世が変化し、どうしてもリアルで集まっての開催ができなくなり、他の多くのイベントと同様にインターネット上での配信による開催に切り替えることとなりました。

オンライン開催となったとき、ではどのような形式で開催するのかということが問題になってきます。配信プラットフォームはどれにするのか、どのように配信を行うのか、日付、時間帯、各トークの長さ、配信を委託するのか自分達でやるのか……

何度か話し合いを行った結果、運営チームにある程度の設備があることから、配信は自分達で行うことに、プラットフォームは強い決め手がある訳ではないですが、YouTube Liveを選択しました。議事録を振り返っていたのですが、全部録画もしくは配信ではなく、録画と配信を希望制にした理由は残っていませんでした。議論するまでもなく、そう決まったのだと思います。

オンラインイベントにすると決まった訳ですが、我々には知見が全くありませんでした。そこで、Kaigi on Railsそのものの宣伝も兼ね、「Kaigi on Rails new」というイベントを開催し、そこでオンラインイベントの "感じ" を掴むことにしました。

[Kaigi on Rails new - Kaigi on Rails | Doorkeeper](https://kaigionrails.doorkeeper.jp/events/109773)

結果様々なKPTを洗い出すことができ、本番までに何を準備すればよいか、どういう運用にすればいいのかが見えてきました。

その後は提出してもらった動画を編集し、書き出したものを共有したりで動画の準備は進んでいきます。機材がない方のために、事前に録画会をやろうという企画もありましたが、希望者少数のため実現しませんでした。

配信勢の皆さんに対しては、直前に配信テスト会を開催してZoomでの登壇の感じをつかんでもらう一方、配信スタッフ側でも実際にどういうオペレーションになるかの細部を詰めました。具体的には登壇者交代がどうなるか、などです。

そして、前述のような構成になりました。

## 当日起こったトラブル
- 目の前の建物から火災ベルが鳴り響き消防車が来る (何事もなかったみたい)
- 連絡用にDiscord通話をしていたiPhoneが高熱により動作停止
- 発表者の画面共有がうまく画面全体に広がってくれない

## 反省点
### 音量のバラつき
事前に頂いていた動画の音量は正規化していたのですが、配信側の音量が想定以上に大きく、相対的に動画のほうが小さく聞こえてしまう問題がありました。アーカイブ公開版では再度正規化を行って、できる限りバラつきがないようにしてあります。

### そもそもの配信構成について
振り返ってみると、配信にあたって回線を冗長化するよりは、オペレーターを冗長構成にすべきだったかもしれません。要するに配信環境を1箇所に構築し、そこに配信担当者が集合するという体制です。今回は何事もなく終わりましたし、何事があってもイベントが進行するように準備をしましたが、次回どうするかはまた考える必要があります。何事もそうですが。

## 参考にした情報
- [Hiroshi SHIBATAさんはTwitterを使っています 「#rubykaigi のお届け会場です https://t.co/fd29Kv9rh0」 / Twitter](https://twitter.com/hsbt/status/1301694864585678848)
- [JANOG46でオンラインとオフラインを繋いできた | JANOG46](https://www.janog.gr.jp/meeting/janog46/nl-009/)
- [Amazon WorkSpacesで堅牢な配信を実現する｜NUMAGUCHI, Shigeru｜note](https://note.com/s_numaguchi/n/n3176232300b3)
- [まだ手元のパソコンでイベント配信してるんですか？クラウド上でTeamsを利用してOBSで配信した方が楽ですよ。 | 技術的な何か。](https://level69.net/archives/27811)
    - これは開催後に公開された記事ですが……

## 今後
Kaigi on Railsは来年も開催することが決定となっていますが、「やる」以外は何も決まっていません(本当に、何も……)。配信環境についても、今回の反省を活かして何かしらの改善を行っていきたいですね。例えばクラウド上からの配信にしたり、配信用機材を導入したりといったことが考えられます。1年かけて、ゆっくり考えていきたいです。

---------

この記事はHHKB Professional HYBRID Type-SとHelixPicoとChoco60で書かれました。
